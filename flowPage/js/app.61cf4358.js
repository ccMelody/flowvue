(function(e){function t(t){for(var i,a,s=t[0],c=t[1],l=t[2],u=0,h=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);d&&d(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={app:0},r=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"02b5":function(e,t,n){},"04ae":function(e,t,n){"use strict";n("02b5")},"16bb":function(e,t,n){"use strict";n("1f92")},"1f92":function(e,t,n){},"22b4":function(e,t,n){"use strict";n("eaeb")},"2b6c":function(e,t,n){},4119:function(e,t,n){"use strict";n("830c")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("4d63"),n("ac1f"),n("25f0"),n("466d"),n("841c");var i=n("a026"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("keep-alive",[e.$route.meta.keepAlive?n("router-view"):e._e()],1),e.$route.meta.keepAlive?e._e():n("router-view")],1)},r=[],a=(n("7faf"),n("2877")),s={},c=Object(a["a"])(s,o,r,!1,null,null,null),l=c.exports,d=n("8c4f"),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.processLoading,expression:"processLoading"}],staticClass:"page"},[n("header",{staticClass:"page__header"},[n("div",{staticClass:"page-actions"}),n("el-button",{staticClass:"publish-btn",attrs:{size:"small"},on:{click:e.publish}},[e._v("发布")])],1),n("section",{staticClass:"page__content"},[e.mockData?n("Process",{ref:"processDesign",attrs:{conf:e.mockData.processData,tabName:"processDesign"},on:{startNodeChange:e.onStartChange}}):e._e()],1)])},h=[],p=n("1da1"),f=(n("96cf"),n("159b"),n("d3b7"),n("3ca3"),n("ddb0"),n("2909")),v=n("53ca"),y=(n("b64b"),n("caad"),n("2532"),n("2638")),g=n.n(y),m=(n("a15b"),n("498a"),n("99af"),n("d81d"),n("fb6a"),n("b85c")),b=n("d4ec"),k=n("bee2"),N=(n("1276"),n("c740"),n("a434"),{start:{type:"start",content:"所有人",properties:{title:"发起人",initiator:[]}},approver:{type:"approver",content:"发起人自选",properties:{approvers:[],assigneeType:"optional",counterSign:!0,optionalMultiUser:!1,title:"审批人"},approverConfig:{type:4,signType:"and",users:[],grade:1,gradeNext:!0,allowMulti:!1}},copy:{type:"copy",content:"发起人自选",properties:{title:"抄送人",menbers:[],userOptional:!0},copyConfig:{users:[],allowSelfChoose:!0}},condition:{type:"condition",content:"请设置条件",properties:{title:"条件",conditions:[],initiator:null}},branch:{type:"branch",content:"",properties:{}},empty:{type:"empty",content:"",properties:{}}}),C=function(e){return!Array.isArray(e)||0===e.length},x=function(){function e(){Object(b["a"])(this,e)}return Object(k["a"])(e,null,[{key:"idGenerator",value:function(){var e=new Date-new Date("2020-08-01");e+=Math.ceil(1e3*Math.random());var t="0123456789ABCDEFGHIGKLMNOPQRSTUVWXYZabcdefghigklmnopqrstuvwxyz",n=t.split(""),i=t.length,o=[];do{var r=e%i;e=(e-r)/i,o.push(n[r])}while(e);return o.join("")}},{key:"isConditionNode",value:function(e){return e&&"condition"===e.type}},{key:"isCopyNode",value:function(e){return e&&"copy"===e.type}},{key:"isStartNode",value:function(e){return e&&"start"===e.type}},{key:"isApproverNode",value:function(e){return e&&"approver"===e.type}},{key:"createNode",value:function(e,t){var n=JSON.parse(JSON.stringify(N[e]));return n.nodeId="copy"==e?"ServiceTask_"+this.idGenerator():"approver"==e?"UserTask_"+this.idGenerator():"start"==e?"StratTask_"+this.idGenerator():"empty"==e?"Gateway_"+this.idGenerator():this.idGenerator(),n.prevId=t,n}},{key:"getPreviousNode",value:function(e,t){if(t.nodeId===e)return t;if(t.childNode){var n=this.getPreviousNode(e,t.childNode);if(n)return n}if(t.conditionNodes){var i,o=Object(m["a"])(t.conditionNodes);try{for(o.s();!(i=o.n()).done;){var r=i.value,a=this.getPreviousNode(e,r);if(a)return a}}catch(s){o.e(s)}finally{o.f()}}}},{key:"deleteNode",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getPreviousNode(e.prevId,t);if(n&&"empty"===i.type)if(this.isConditionNode(e)){var o=2===i.conditionNodes.length,r=o?i:e;this.deleteNode(r,t,o)}else C(i.conditionNodes)&&this.deleteNode(i,t),this.deleteNode(e,t,!1);else{var a=function(e,t){e.childNode=t.childNode,C(e.conditionNodes)&&(e.conditionNodes=t.conditionNodes),e.childNode&&(e.childNode.prevId=e.nodeId),e.conditionNodes&&e.conditionNodes.forEach((function(t){return t.prevId=e.nodeId}))};if(this.isConditionNode(e)){var s=i.conditionNodes,c=s.findIndex((function(t){return t.nodeId===e.nodeId}));if(s.length>2)s.splice(c,1);else{var l=s[+!c];if(delete i.conditionNodes,i.childNode){var d=l;while(d.childNode)d=d.childNode;d.childNode=i.childNode,d.childNode.prevId=d.nodeId}a(i,l),i.childNode&&"empty"===i.childNode.type&&this.deleteNode(i.childNode,i)}s.forEach((function(e,t){return e.properties.priority=t}))}else a(i,e)}}},{key:"addApprovalNode",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=e.childNode;n=n||this.createNode("approver",e.nodeId),e.childNode=n,i&&(n.childNode=i,i.prevId=n.nodeId);var o=e.conditionNodes;Array.isArray(o)&&!t&&o.length&&(n.conditionNodes=o.map((function(e){return e.prevId=n.nodeId,e})),delete e.conditionNodes),i&&"empty"===i.type&&"empty"!==n.type&&0===i.conditionNodes.length&&this.deleteNode(i,e)}},{key:"addEmptyNode",value:function(e){var t=this.createNode("empty",e.nodeId);return this.addApprovalNode(e,!0,t),t}},{key:"addCopyNode",value:function(e,t){this.addApprovalNode(e,t,this.createNode("copy",e.nodeId))}},{key:"appendConditionNode",value:function(e){var t=e.conditionNodes,n=this.createNode("condition",e.nodeId),i=t.findIndex((function(e){return e.properties.isDefault}));n.properties.priority=t.length,i>-1?(t.splice(-1,0,n),n.properties.priority=t.length-2,t[t.length-1].properties.priority=t.length-1):t.push(n),this.setDefaultCondition(n,e)}},{key:"appendBranch",value:function(e,t){var n=e;if(Array.isArray(e.conditionNodes)&&e.conditionNodes.length)if(t)n=this.addEmptyNode(n,!0);else{var i=this.addEmptyNode(n,!0);i.conditionNodes=n.conditionNodes,i.conditionNodes.forEach((function(e){e.prevId=i.nodeId}))}var o=[this.createNode("condition",n.nodeId),this.createNode("condition",n.nodeId)].map((function(e,t){return e.properties.title+=t+1,e.properties.priority=t,e}));n.conditionNodes=o}},{key:"resortPrioByCNode",value:function(e,t,n){if(e.properties.isDefault)e.properties.priority=t;else{var i=this.getPreviousNode(e.prevId,n),o=e.properties.priority;if(i.conditionNodes[o].properties.isDefault)e.properties.priority=t;else{var r=i.conditionNodes.splice(o,1,e)[0];r.properties.priority=t,i.conditionNodes[t]=r}}}},{key:"increasePriority",value:function(e,t){if(!e.properties.isDefault){var n=this.getPreviousNode(e.prevId,t),i=n.conditionNodes,o=i.findIndex((function(t){return t===e}));o&&(i[o-1].properties.priority=o,i[o].properties.priority=o-1,i[o-1]=i.splice(o,1,i[o-1])[0])}}},{key:"decreasePriority",value:function(e,t){var n=this.getPreviousNode(e.prevId,t),i=n.conditionNodes,o=i.findIndex((function(t){return t.nodeId===e.nodeId}));if(o<i.length-1){var r=i[o+1];if(r.properties.isDefault)return;r.properties.priority=o,i[o].properties.priority=o+1,i[o+1]=i.splice(o,1,i[o+1])[0]}}},{key:"setDefaultCondition",value:function(e,t){var n="其他情况进入此流程",i=this.getPreviousNode(e.prevId,t).conditionNodes,o=function(e){return e.properties&&(e.properties.initiator||!C(e.properties.conditions))},r=function(e){e.properties.isDefault=!1,e.content===n&&(e.content="请设置条件")},a=function(e){e.properties.isDefault=!0,e.content=n},s=0;i.slice(0,-1).forEach((function(e){o(e)&&s++,r(e)}));var c=i[i.length-1];s>0&&!o(c)?a(c):r(c)}},{key:"checkNode",value:function(e,t){var n=!0,i=e.properties;this.isStartNode(e)&&!i.initiator&&(n=!1),this.isConditionNode(e)&&!i.isDefault&&!i.initiator&&C(i.conditions)&&(n=!1);var o=["myself","optional","director"];return this.isApproverNode(e)&&!o.includes(i.assigneeType)&&C(i.approvers)&&(n=!1),n}},{key:"checkAllNode",value:function(e){var t=this,n=!0,i=function e(n,i,o){!t.checkNode(n,o)&&i(),n.childNode&&e(n.childNode,i,o),C(n.conditionNodes)||n.conditionNodes.forEach((function(t){return e(t,i,n)}))};return i(e,(function(){return n=!1})),n}}]),e}();function w(){var e=x.createNode("start");return e.childNode=x.createNode("approver",e.nodeId),e}var D=function(e){return"condition"===e.type},_=function(e){return Array.isArray(e)&&e.length>0},O=function(e){return _(e.conditionNodes)},S=function(e){return e.stopPropagation()};function I(e,t,n){var i=this,o=["flow-path-card"],r=function(e,t){return e&&o.push(t),e},a=r(x.isStartNode(t),"start-node"),s=r(x.isApproverNode(t),"approver"),c=r(x.isCopyNode(t),"copy");return n("section",{class:o.join(" "),on:{click:a?function(){}:this.eventLancher.bind(e,"edit",t)}},[n("header",{class:"header"},[n("div",{class:"title-box",style:"height: 100%;width:190px;"},[s&&n("i",{class:"iconfont iconshenpi",style:"font-size:12px;color:white;margin-right:4px;"}),c&&n("i",{class:"el-icon-s-promotion",style:"font-size:12px;color:white;margin-right:4px;"}),n("span",{class:"title-text"},[t.properties.title]),!a&&n("input",g()([{on:{blur:function(e){i.$forceUpdate()},input:function(e){e.target.composing||i.$set(t.properties,"title",e.target.value.trim())},click:S},class:"title-input",style:"margin-top:3px;",domProps:{value:t.properties.title}},{directives:[{name:"model",value:t.properties.title,modifiers:{trim:!0}}]}]))]),n("div",{class:"actions",style:"margin-right:4px;"},[n("i",{class:"el-icon-close icon",on:{click:this.eventLancher.bind(e,"deleteNode",t,e.data)}})])]),n("div",{class:"body"},[n("span",{class:"text"},[t.content]),n("div",{class:"icon-wrapper right"},[n("i",{class:"el-icon-arrow-right icon right-arrow"})])])])}var T=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return I.call.apply(I,[t[0]].concat(t))},E={start:T,approver:T,copy:T,empty:function(e){return""},condition:function(e,t,n){var i=this;return n("section",{class:"flow-path-card condition",on:{click:this.eventLancher.bind(e,"edit",t)}},[n("header",{class:"header"},[n("div",{class:"title-box",style:"height: 20px;width:160px;"},[n("span",{class:"title-text"},[t.properties.title]),n("input",g()([{on:{blur:function(e){i.$forceUpdate()},input:function(e){e.target.composing||i.$set(t.properties,"title",e.target.value.trim())},click:S},class:"title-input",style:"margin-top:1px;",domProps:{value:t.properties.title}},{directives:[{name:"model",value:t.properties.title,modifiers:{trim:!0}}]}]))]),n("span",{class:"priority"},["优先级",t.properties.priority+1]),n("div",{class:"actions"},[n("i",{class:"el-icon-close icon",on:{click:this.eventLancher.bind(e,"deleteNode",t,e.data)}})])]),n("div",{class:"body"},[n("pre",{class:"text"},[t.content])]),n("div",{class:"icon-wrapper left",on:{click:e.eventLancher.bind(e,"increasePriority",t,e.data)}},[n("i",{class:"el-icon-arrow-left icon left-arrow"})]),n("div",{class:"icon-wrapper right",on:{click:e.eventLancher.bind(e,"decreasePriority",t,e.data)}},[n("i",{class:"el-icon-arrow-right icon right-arrow"})])])}};function K(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=(O(t),"empty"===t.type);return o&&!i?"":n("div",{class:"add-node-btn-box flex  justify-center"},[n("div",{class:"add-node-btn"},[n("el-popover",{attrs:{placement:"right",trigger:"click",width:"300"}},[n("div",{class:"condition-box"},[n("div",[n("div",{class:"condition-icon",on:{click:e.eventLancher.bind(e,"addApprovalNode",t,i)}},[n("i",{class:"iconfont iconshenpi"})]),"审批人"]),n("div",[n("div",{class:"condition-icon",on:{click:e.eventLancher.bind(e,"addCopyNode",t,i)}},[n("i",{class:"el-icon-s-promotion iconfont",style:"vertical-align: middle;"})]),"抄送人"]),n("div",[n("div",{class:"condition-icon",on:{click:this.eventLancher.bind(e,"appendBranch",t,i)}},[n("i",{class:"iconfont iconcondition"})]),"条件分支"])]),n("button",{class:"btn",attrs:{type:"button"},slot:"reference"},[n("i",{class:"el-icon-plus icon"})])])])])}function $(e,t,n){if(t){var i=e.verifyMode&&!1===x.checkNode(t),o=[],r="",a=n("div",{class:"node-wrap"},[n("div",{class:"node-wrap-box ".concat(t.type," ").concat(i?"error":"")},[n("el-tooltip",{attrs:{content:"未设置条件",placement:"top",effect:"dark"}},[n("div",{class:"error-tip",on:{click:this.eventLancher.bind(e,"edit",t)}},["!!!"])]),E[t.type].call(e,e,t,n),K.call(e,e,t,n)])]);return O(t)&&(r=n("div",{class:"branch-wrap"},[n("div",{class:"branch-box-wrap"},[n("div",{class:"branch-box  flex justify-center relative"},[n("button",{class:"btn",on:{click:this.eventLancher.bind(e,"appendConditionNode",t)}},["添加条件"]),t.conditionNodes.map((function(t){return $.call(e,e,t,n)}))])]),K.call(e,e,t,n,!0)])),D(t)?n("div",{class:"col-box"},[n("div",{class:"center-line"}),n("div",{class:"top-cover-line"}),n("div",{class:"bottom-cover-line"}),a,r,$.call(e,e,t.childNode,n)]):(o.push(a),r&&o.push(r),t.childNode&&o.push($.call(e,e,t.childNode,n)),o)}}function P(e){return e("section",{class:"end-node"},["流程结束"])}var L,A,j,M={props:{data:{type:Object,required:!0},verifyMode:{type:Boolean,default:!0}},watch:{},methods:{eventLancher:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var o={event:e,args:n.slice(0,-1)};this.$emit("emits",o)}},render:function(e){return e("div",{style:"display: inline-flex; flex-direction: column; align-items: center;"},[this.data&&$.call(this,this,this.data,e),P(e)])}},B=M,F=(n("16bb"),Object(a["a"])(B,L,A,!1,null,"66aec45f",null)),V=F.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.properties?n("el-drawer",{staticClass:"drawer",staticStyle:{"text-align":"left"},attrs:{size:"550px",visible:e.visible,"show-close":!1},on:{"update:visible":function(t){e.visible=t},close:e.cancel}},[e.value&&"start"==e.value.type&&e.properties.title?n("header",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[e._v(e._s(e.properties.title))]):n("header",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[n("span",{directives:[{name:"show",rawName:"v-show",value:!e.titleInputVisible,expression:"!titleInputVisible"}],staticStyle:{cursor:"pointer"},on:{click:function(t){e.titleInputVisible=!0}}},[e._v(" "+e._s(e.properties.title)+" "),n("i",{staticClass:"el-icon-edit"})]),n("el-input",{directives:[{name:"show",rawName:"v-show",value:e.titleInputVisible,expression:"titleInputVisible"},{name:"clickoutside",rawName:"v-clickoutside",value:function(t){return e.titleInputVisible=!1},expression:"_ => titleInputVisible=false"}],staticStyle:{"z-index":"9","max-width":"200px"},attrs:{size:"mini"},model:{value:e.properties.title,callback:function(t){e.$set(e.properties,"title",t)},expression:"properties.title"}}),e.isConditionNode()?n("el-select",{staticClass:"priority-select",attrs:{size:"mini"},model:{value:e.properties.priority,callback:function(t){e.$set(e.properties,"priority",t)},expression:"properties.priority"}},e._l(e.priorityLength,(function(e){return n("el-option",{key:e,attrs:{value:e-1,label:"优先级"+e}})})),1):e._e()],1),e.value&&e.isConditionNode()?n("section",{staticClass:"condition-pane"},[e.showingPCons.includes(-1)?n("row-wrapper",{attrs:{title:"发起人"}},[n("fc-org-select",{ref:"condition-org",attrs:{tabList:["dep&user","role"]},model:{value:e.initiator,callback:function(t){e.initiator=t},expression:"initiator"}})],1):e._e(),e._l(e.pconditions,(function(t,i){return[e.couldShowIt(t,"el-input-number","fc-date-duration","fc-time-duration","fc-amount","fc-calculate","number")?n("row-wrapper",{key:i,attrs:{title:t.fieldName},scopedSlots:e._u([{key:"action",fn:function(){return[n("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer"},on:{click:function(n){return e.onDelCondition(t)}}})]},proxy:!0}],null,!0)},[n("num-input",{key:i,staticStyle:{"padding-right":"6px"},attrs:{title:e.timeTangeLabel(t)},model:{value:t.conditionValue,callback:function(n){e.$set(t,"conditionValue",n)},expression:"item.conditionValue"}})],1):e._e(),e.couldShowIt(t,"el-select")?n("row-wrapper",{key:i,attrs:{title:t.fieldName},scopedSlots:e._u([{key:"action",fn:function(){return[n("i",{staticClass:"el-icon-delete",staticStyle:{cursor:"pointer"},on:{click:function(n){return e.onDelCondition(t)}}})]},proxy:!0}],null,!0)},[n("el-select",{staticStyle:{width:"100%"},attrs:{multiple:"",placeholder:"请选择",size:"small"},model:{value:t.conditionValue,callback:function(n){e.$set(t,"conditionValue",n)},expression:"item.conditionValue"}},e._l(t.option,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e()]})),n("div",{staticStyle:{"padding-left":"10px","margin-top":"2em"}},[n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加条件")]),n("span",{staticStyle:{color:"#aaa","margin-left":"16px"}},[e._v("还有"+e._s(e.notUseConNum)+"个可用条件")])],1)],2):e._e(),e.value&&(e.isApproverNode()||e.isStartNode())?n("section",{staticClass:"approver-pane",staticStyle:{height:"100%"}},[n("el-tabs",{staticClass:"pane-tab",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"设置"+("approver"===e.value.type?"审批人":"发起人"),name:"config"}},["start"===e.value.type?n("el-row",{staticStyle:{padding:"10px"}},[n("el-col",{staticStyle:{"font-size":"12px"},attrs:{span:4}},[e._v("发起人")]),n("el-col",{staticStyle:{"padding-left":"12px"},attrs:{span:18}},[n("fc-org-select",{ref:"start-org",attrs:{tabList:["dep&user"]},model:{value:e.initiator,callback:function(t){e.initiator=t},expression:"initiator"}})],1)],1):"approver"===e.value.type?n("div",[n("div",{staticStyle:{padding:"12px"}},[n("el-radio-group",{staticStyle:{"line-height":"32px"},on:{change:e.resetOrgColl},model:{value:e.approverForm.assigneeType,callback:function(t){e.$set(e.approverForm,"assigneeType",t)},expression:"approverForm.assigneeType"}},e._l(e.assigneeTypeOptions,(function(t){return n("el-radio",{key:t.value,staticClass:"radio-item",attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1),n("div",{staticStyle:{"border-bottom":"1px solid #e5e5e5","padding-bottom":"1rem"}},["myself"===e.approverForm.assigneeType?n("div",{staticClass:"option-box",staticStyle:{color:"#a5a5a5"}},[e._v("发起人自己将作为审批人处理审批单")]):"optional"===e.approverForm.assigneeType?n("div",{staticClass:"option-box"},[n("p",[e._v("可选多人")]),n("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:e.approverForm.optionalMultiUser,callback:function(t){e.$set(e.approverForm,"optionalMultiUser",t)},expression:"approverForm.optionalMultiUser"}})],1):"director"===e.approverForm.assigneeType?n("div",[n("div",{staticStyle:{"font-size":"14px","padding-left":"1rem"}},[e._v("发起人的 "),n("el-select",{attrs:{size:"small"},model:{value:e.directorLevel,callback:function(t){e.directorLevel=t},expression:"directorLevel"}},e._l(5,(function(e){return n("el-option",{key:e,attrs:{label:1===e?"直接主管":"第"+e+"级主管",value:e}})})),1),n("br"),n("el-checkbox",{staticStyle:{"margin-top":"1rem"},model:{value:e.useDirectorProxy,callback:function(t){e.useDirectorProxy=t},expression:"useDirectorProxy"}},[e._v("找不到主管时，由上级主管代审批")])],1)]):n("div",{staticClass:"option-box"},[n("fc-org-select",{ref:"approver-org",attrs:{buttonType:"button",title:e.getAssignTypeLabel(),tabList:e.fcOrgTabList.includes(e.approverForm.assigneeType)?[e.approverForm.assigneeType]:["dep"]},on:{change:e.onOrgChange},model:{value:e.orgCollection,callback:function(t){e.orgCollection=t},expression:"orgCollection"}})],1)]),e.orgCollection[e.approverForm.assigneeType]&&e.orgCollection[e.approverForm.assigneeType].length>1||["optional","director","role"].includes(e.approverForm.assigneeType)?n("div",{staticClass:"option-box",staticStyle:{"border-bottom":"1px solid #e5e5e5"}},[n("p",[e._v("多人审批时采用的审批方式")]),n("el-radio",{staticClass:"radio-item",attrs:{label:!0},model:{value:e.approverForm.counterSign,callback:function(t){e.$set(e.approverForm,"counterSign",t)},expression:"approverForm.counterSign"}},[e._v("会签（须所有审批人同意）")]),n("br"),n("el-radio",{staticClass:"radio-item",attrs:{label:!1},model:{value:e.approverForm.counterSign,callback:function(t){e.$set(e.approverForm,"counterSign",t)},expression:"approverForm.counterSign"}},[e._v("或签（一名审批人同意或拒绝即可）")])],1):e._e()]):e._e()],1)],1)],1):e._e(),e.value&&e.isCopyNode()?n("section",{staticStyle:{"padding-left":"1rem"}},[n("p",[e._v("抄送人")]),n("fc-org-select",{ref:"copy-org",attrs:{tabList:["user"],buttonType:"button",title:"抄送人"},model:{value:e.properties.menbers,callback:function(t){e.$set(e.properties,"menbers",t)},expression:"properties.menbers"}}),n("br"),n("el-checkbox",{model:{value:e.properties.userOptional,callback:function(t){e.$set(e.properties,"userOptional",t)},expression:"properties.userOptional"}},[e._v("允许发起人自选抄送人")])],1):e._e(),n("el-dialog",{attrs:{title:"选择条件",visible:e.dialogVisible,width:"500px","append-to-body":!0,"custom-class":"condition-dialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-checkbox-group",{model:{value:e.showingPCons,callback:function(t){e.showingPCons=t},expression:"showingPCons"}},[n("el-checkbox",{attrs:{label:-1}},[e._v("发起人")]),e._l(e.pconditions,(function(t,i){return n("el-checkbox",{key:i,attrs:{label:t.field}},[e._v(" "+e._s(t.fieldName)+" ")])}))],2)],1),n("div",{staticClass:"actions"},[n("el-button",{attrs:{size:"small"},on:{click:e.cancel}},[e._v("取消")]),n("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.confirm}},[e._v("确定")])],1)],1):e._e()},z=[],q=(n("7db0"),n("4de4"),n("5530")),U=n("bc3a"),J=n.n(U),H=n("5c96"),G=n.n(H);try{var W=window.location,Y=W.pathname.split("/")[1];j=W.protocol+"//"+W.host+"/"+Y}catch(ln){}J.a.defaults.baseURL=j,J.a.defaults.timeout=1e5,J.a.defaults.validateStatus=function(e){return e>=200&&e<=500},J.a.defaults.withCredentials=!0,J.a.interceptors.request.use((function(e){e.meta;return!0===e.text&&(e.headers["Content-Type"]="text/plain"),e}),(function(e){return Promise.reject(e)})),J.a.interceptors.response.use((function(e){var t=e.data.code||0===e.data.code||e.status,n=e.data.msg||e.data.error_description||"未知错误";return 401===t&&alert("401"),200!==t&&1e3!==t?(Object(H["Message"])({message:'<section style="line-height: 22px">'.concat(n,"</section>"),type:"error",dangerouslyUseHTMLString:!0,showClose:!0}),Promise.reject(new Error(n))):e}),(function(e){return console.log(e),Promise.reject(new Error(e))}));var Q,X,Z=J.a,ee=function(e,t){return Z({url:"oaBillConfigController.do?getProcessConfig",method:"get",params:{accountbookId:e,billType:t}})},te=function(e,t){return Z({url:"oaBillConfigController.do?getFieldConfig",method:"get",params:{accountbookId:e,billType:t}})},ne=function(e,t,n){return Z({url:"oaBillConfigController.do?saveProcessConfig",method:"post",params:{accountbookId:e,billType:t},data:n})},ie=function(e){return Z({url:"newDepartDetailController.do?treeList",method:"get",params:{accountbookId:e}})},oe=function(e){return Z({url:"newDepartDetailController.do?userListByDepartDetailId",method:"get",params:{departDetailId:e}})},re=function(e,t){return Z({url:"newDepartDetailController.do?userListByUserName",method:"get",params:{accountbookId:e,userName:t}})},ae=function(e){return Z({url:"staffLevelController.do?getListForOA",method:"get",params:Object(q["a"])({},e)})},se=n("9169"),ce=function(e,t){var n=t._c;return n("el-row",{staticClass:"cmp-container"},[n("el-col",{staticClass:"label",attrs:{span:4}},[t._v(t._s(t.props.title))]),n("el-col",{attrs:{span:18}},[t._t("default")],2),n("el-col",{staticClass:"icon-wrapper",attrs:{span:2}},[t._t("action")],2)],1)},le=[],de=(n("84f9"),{}),ue=Object(a["a"])(de,ce,le,!0,null,"4f652313",null),he=ue.exports,pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{attrs:{gutter:12}},[n("el-col",{attrs:{span:e.isRange?24:12}},[n("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"请选择"},on:{change:e.onTypeChange},model:{value:e.cloneData.type,callback:function(t){e.$set(e.cloneData,"type",t)},expression:"cloneData.type"}},[n("el-option",{attrs:{label:"小于",value:"lt"}}),n("el-option",{attrs:{label:"小于等于",value:"lte"}}),n("el-option",{attrs:{label:"大于",value:"gt"}}),n("el-option",{attrs:{label:"大于等于",value:"gte"}}),n("el-option",{attrs:{label:"等于",value:"eq"}}),n("el-option",{attrs:{label:"介于两数之间",value:"bet"}})],1)],1),n("el-col",{attrs:{span:e.isRange?24:12}},[e.isRange?n("div",{staticStyle:{width:"100%",overflow:"hidden","margin-top":"10px"}},[n("el-col",{staticStyle:{"padding-left":"0"},attrs:{span:6}},[n("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small","controls-position":"right"},on:{change:e.update},model:{value:e.cloneData.value[0],callback:function(t){e.$set(e.cloneData.value,0,t)},expression:"cloneData.value[0]"}})],1),n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{size:"small",placeholder:"请选择"},on:{change:e.update},model:{value:e.cloneData.value[1],callback:function(t){e.$set(e.cloneData.value,1,t)},expression:"cloneData.value[1]"}},[n("el-option",{attrs:{label:"<",value:"lt"}}),n("el-option",{attrs:{label:"≤",value:"lte"}})],1)],1),n("el-col",{staticClass:"range-title",attrs:{span:4,title:e.title}},[e._v(e._s(e.title))]),n("el-col",{attrs:{span:4}},[n("el-select",{attrs:{size:"small",placeholder:"请选择"},on:{change:e.update},model:{value:e.cloneData.value[2],callback:function(t){e.$set(e.cloneData.value,2,t)},expression:"cloneData.value[2]"}},[n("el-option",{attrs:{label:"<",value:"lt"}}),n("el-option",{attrs:{label:"≤",value:"lte"}})],1)],1),n("el-col",{staticStyle:{"padding-left":"0"},attrs:{span:6}},[n("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small","controls-position":"right"},on:{change:e.update},model:{value:e.cloneData.value[3],callback:function(t){e.$set(e.cloneData.value,3,t)},expression:"cloneData.value[3]"}})],1)],1):n("el-input-number",{staticStyle:{width:"100%"},attrs:{size:"small","controls-position":"right"},on:{change:e.update},model:{value:e.cloneData.value,callback:function(t){e.$set(e.cloneData,"value",t)},expression:"cloneData.value"}})],1)],1)},fe=[],ve={model:{prop:"value",event:"update"},props:["value","title"],components:{"row-wrapper":he},data:function(){var e=JSON.parse(JSON.stringify(this.value||{}));return e=Object.assign({type:"gt",value:null},e),{cloneData:e}},computed:{isRange:function(){return"bet"===this.cloneData.type}},mounted:function(){this.update()},methods:{onTypeChange:function(e){"bet"===e&&(this.cloneData.value=[1,"lt","lt",2]),this.update()},update:function(){this.$emit("update",this.cloneData)}}},ye=ve,ge=(n("c9fb"),Object(a["a"])(ye,pe,fe,!1,null,"3e566cb4",null)),me=ge.exports,be={lt:"<",lte:"≤",gt:">",gte:"≥",eq:"="},ke={lt:"<",lte:"<=",gt:">",gte:">=",eq:"=="},Ne={approvers:[],assigneeType:"user",counterSign:!0,optionalMultiUser:!1},Ce={props:["value","processData"],data:function(){return{fcOrgTabList:["dep","role","user","position"],visible:!1,titleInputVisible:!1,activeName:"config",showingPCons:[],pconditions:[],dialogVisible:!1,properties:{},initiator:{"dep&user":[],role:[]},priorityLength:0,orgCollection:{dep:[],role:[],user:[],position:[]},useDirectorProxy:!0,directorLevel:1,startForm:{formOperates:[]},approverForm:JSON.parse(JSON.stringify(Ne)),optionalOptions:[{label:"自选一个人",value:!1},{label:"自选多个人",value:!0}],assigneeTypeOptions:[{label:"指定成员",value:"user",id:1},{label:"主管",value:"director",id:2},{label:"发起人自己",value:"myself",id:3},{label:"发起人自选",value:"optional",id:4},{label:"职级",value:"role",id:5}],approverConfig:{}}},computed:{notUseConNum:function(){return this.pconditions.length-this.showingPCons.length+1}},created:function(){this.getCondition()},directives:{Clickoutside:se["a"]},methods:{resetOrgColl:function(){for(var e in this.orgCollection)this.$set(this.orgCollection,e,[])},onOrgChange:function(e){},timeTangeLabel:function(e){var t=["fc-time-duration","fc-date-duration"].findIndex((function(t){return t===e.tag}));return t>-1?"时长"+["(小时)","(天)"][t]:e.label},getAssignTypeLabel:function(){var e=this,t=this.assigneeTypeOptions.find((function(t){return t.value===e.approverForm.assigneeType}));return t?t.label:""},couldShowIt:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.includes(e.fieldType)&&this.showingPCons.includes(e.field)},initCopyNode:function(){this.properties=this.value.properties},initStartNodeData:function(){this.initInitiator()},copyNodeConfirm:function(){var e=this;console.log("this.properties.menbers",this.properties.menbers);var t=[];Object.keys(this.properties.menbers)&&Object.keys(this.properties.menbers).forEach((function(n){return[t=e.properties.menbers[n].map((function(e){return e.id}))]}));var n={users:t,allowSelfChoose:this.properties.userOptional};console.log("抄送-confirm",this.properties),this.$emit("confirm",this.properties,this.getOrgSelectLabel("copy")||"发起人自选","copyNode",n),this.visible=!1},conditionNodeComfirm:function(){var e=this,t="",n=[];this.showingPCons.map((function(t){return e.pconditions.find((function(e){return e.field===t}))})).forEach((function(i){if(i){var o=i.conditionValue;if(void 0!==o&&null!==o&&0!=o.length){var r=["el-input-number","fc-date-duration","fc-time-duration","fc-amount","fc-calculate","number"];if(r.includes(i.fieldType))if("bet"===o.type){var a=o.value;t+="[".concat(a[0]," ").concat(be[a[1]]," ").concat(i.fieldName," ").concat(be[a[2]]," ").concat(a[3],"] ")+"\n"}else t+="[".concat(i.fieldName," ").concat(be[o.type]," ").concat(o.value,"] ")+"\n";else if("fc-org-select"===i.fieldType){var s=e.pconditions.findIndex((function(e){return e.field===i.field})),c=e.$refs["org"+s][0].selectedLabels;t+="[".concat(i.fieldName," = ").concat(c,"] ")+"\n"}else if("el-select"===i.fieldType){var l=[];o&&o.length&&o.forEach((function(e){i.option.forEach((function(t){t.value==e&&l.push(t.label)}))}));var d=l.join(",");t+="[".concat(i.fieldName," = ").concat(d,"] ")+"\n"}else t+="[".concat(i.fieldName," = ").concat(o,"] ")+"\n";var u={field:i.field,conditionValue:o,fieldType:i.fieldType,fieldName:i.fieldName};n.push(u)}}}),[]),console.log("conditions",n),this.properties.conditions=n,this.properties.initiator=this.initiator,console.log("发起人----",this.initiator,"getOrgSelectLabel",!!this.getOrgSelectLabel("condition")),this.initiator&&this.getOrgSelectLabel("condition")&&(t="[发起人: ".concat(this.getOrgSelectLabel("condition"),"]")+"\n"+t);var i=[{field:"userId",fieldName:"提交人",fieldType:"string",operator:"=",value:[]},{field:"departDetailId",fieldName:"提交部门",fieldType:"string",operator:"=",value:[]},{field:"staffLevelId",fieldName:"职级",fieldType:"string",operator:"=",value:[]}];this.properties.initiator&&this.properties.initiator["dep&user"].forEach((function(e){e.hasOwnProperty("realName")?i[0].value.push(e.id):i[1].value.push(e.id)})),this.properties.initiator&&this.properties.initiator["role"].forEach((function(e){i[2].value.push(e.id)})),i[0].value=i[0].value.join(),i[1].value=i[1].value.join(),i[2].value=i[2].value.join(),n.forEach((function(e){var t={field:e.field,fieldName:e.fieldName,fieldType:e.fieldType};if("number"==e.fieldType&&"bet"!=e.conditionValue.type)t.operator=ke[e.conditionValue.type],t.value=e.conditionValue.value,i.push(t);else if("el-select"==e.fieldType)t.operator="==",t.value=e.conditionValue.join(","),i.push(t);else{var n=Object.assign({},t);t.operator=ke[e.conditionValue.value[1]],t.value=e.conditionValue.value[0],i.push(t),n.operator=ke[e.conditionValue.value[2]],n.value=e.conditionValue.value[3],i.push(n)}})),i=i.filter((function(e){return""!==e.value})),this.$emit("confirm",this.properties,t||"请设置条件","conditionNode",i),this.visible=!1},getOrgSelectLabel:function(e){return this.$refs[e+"-org"]&&this.$refs[e+"-org"]["selectedLabels"]||""},startNodeComfirm:function(){this.properties.initiator=this.initiator["dep&user"],this.$emit("confirm",this.properties,this.getOrgSelectLabel("start")||"所有人"),this.visible=!1},approverNodeComfirm:function(){var e=this.approverForm.assigneeType,t="";t=["optional","myself"].includes(e)?this.assigneeTypeOptions.find((function(t){return t.value===e})).label:"director"===e?1===this.directorLevel?"直接主管":"第".concat(this.directorLevel,"级主管"):this.getOrgSelectLabel("approver"),this.approverForm.approvers=this.orgCollection[e],Object.assign(this.properties,this.approverForm);var n=this.assigneeTypeOptions.findIndex((function(t){return t.value==e})),i=[],o=[];5==this.assigneeTypeOptions[n].id?o=this.properties.approvers&&this.properties.approvers.map((function(e){return e.id})):i=this.properties.approvers&&this.properties.approvers.map((function(e){return e.id})),this.approverConfig={type:this.assigneeTypeOptions[n].id,signType:this.properties.counterSign?"and":"or",users:i,staffLevel:o,grade:this.directorLevel,gradeNext:this.useDirectorProxy,allowMulti:this.properties.optionalMultiUser},this.$emit("confirm",this.properties,t||"请设置审批人","approverNode",this.approverConfig),this.visible=!1},confirm:function(){this.isCopyNode()&&this.copyNodeConfirm(),this.isStartNode()&&this.startNodeComfirm(),this.isApproverNode()&&this.approverNodeComfirm(),this.isConditionNode()&&this.conditionNodeComfirm()},cancel:function(){var e=this;setTimeout((function(){e.$emit("cancel"),e.visible=!1}),0)},onDelCondition:function(e){var t=this.showingPCons.findIndex((function(t){return t===e.field}));t>-1&&(this.showingPCons.splice(t,1),this.pconditions.find((function(t){return t.field===e.field})).conditionValue=void 0)},getPrevData:function(){return x.getPreviousNode(this.value.prevId,this.processData)},getPriorityLength:function(){this.priorityLength=this.getPrevData().conditionNodes.length},isConditionNode:function(){return!!this.value&&x.isConditionNode(this.value)},isApproverNode:function(){return!!this.value&&x.isApproverNode(this.value)},isStartNode:function(){return!!this.value&&x.isStartNode(this.value)},isCopyNode:function(){return!!this.value&&x.isCopyNode(this.value)},initInitiator:function(){var e=this.value.properties&&this.value.properties.initiator;this.initiator["dep&user"]=Array.isArray(e)?e:[]},initApproverNodeData:function(){for(var e in this.approverForm)this.value.properties.hasOwnProperty(e)&&(this.approverForm[e]=this.value.properties[e]);var t=this.approverForm.approvers;this.resetOrgColl(),Array.isArray(this.approverForm.approvers)&&(this.orgCollection[this.approverForm.assigneeType]=t)},initConditionNodeData:function(){var e=this,t=this.value.properties&&this.value.properties.conditions;this.initiator=this.value.properties.initiator,Array.isArray(this.pconditions)&&(this.showingPCons=[-1],this.pconditions.forEach((function(n){var i=void 0;if(Array.isArray(t)){var o=t.find((function(e){return e.field==n.field}));o&&o.conditionValue&&(i=o.conditionValue,e.showingPCons.push(n.field))}e.$set(n,"conditionValue",i)})))},getCondition:function(){var e=this,t=window.ccAccountbookId,n=window.ccBillType;te(t,n).then((function(t){""!=t.data&&(e.pconditions=JSON.parse(t.data))}))}},watch:{visible:function(e){e?(this.isStartNode()&&this.initStartNodeData(),this.isApproverNode()&&this.initApproverNodeData(),this.isConditionNode()&&this.initConditionNodeData()):this.approverForm=JSON.parse(JSON.stringify(Ne))},value:function(e){e&&e.properties&&(console.log("value---",e),this.visible=!0,this.properties=JSON.parse(JSON.stringify(e.properties)),this.properties&&x.isConditionNode(e)&&this.getPriorityLength())}},components:{"num-input":me,"row-wrapper":he}},xe=Ce,we=(n("04ae"),n("b560"),Object(a["a"])(xe,R,z,!1,null,"399b96c0",null)),De=we.exports,_e={name:"Process",props:["tabName","conf"],data:function(){var e=w();return this.conf&&"object"===Object(v["a"])(this.conf)&&Object.keys(this.conf).length&&(e=this.conf),console.log("detail-data",e),{data:e,scaleVal:100,step:5,updateId:0,activeData:null,isProcessCmp:!0,verifyMode:!1}},methods:{getData:function(){return this.verifyMode=!0,x.checkAllNode(this.data)?Promise.resolve({formData:this.data}):Promise.reject({target:this.tabName})},eventReciver:function(e){var t=e.event,n=e.args;"edit"!==t?(x[t].apply(x,Object(f["a"])(n)),this.forceUpdate()):this.activeData=n[0]},forceUpdate:function(){this.updateId=this.updateId+1},changeScale:function(e){var t=this.scaleVal+e;t>0&&t<=200&&(this.scaleVal=t)},onPropEditConfirm:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"startNode",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.activeData.content=t||"请设置条件";var o=this.activeData.properties;this.activeData.properties=e,"approverNode"==n?this.activeData.approverConfig=i:"copyNode"==n?this.activeData.copyConfig=i:"conditionNode"==n&&(this.activeData.conditionConfigs=i),x.isConditionNode(this.activeData)&&(e.priority!==o.priority&&x.resortPrioByCNode(this.activeData,o.priority,this.data),x.setDefaultCondition(this.activeData,this.data)),x.isStartNode(this.activeData)&&this.$emit("startNodeChange",this.data),this.onClosePanel(),this.forceUpdate()},onClosePanel:function(){this.activeData=null},isFilledPCon:function(e){var t=!1,n=function(e,t){return e.childNode&&i(e.childNode,t)},i=function(i,o){if(!t&&i){if(Array.isArray(i.conditionNodes)){var r=i.conditionNodes.some((function(t){var n=t.properties.conditions||[];return Array.isArray(e)?n.some((function(t){return e.includes(t.formId)})):n.length>0}));r?o():i.conditionNodes.forEach((function(e){return n(e,o)}))}n(i,o)}};return i(this.data,(function(){return t=!0})),t}},render:function(e){return e("div",{class:"flow-container"},[e("div",{class:"scale-slider"},[e("i",{class:"btn  el-icon-minus",on:{click:this.changeScale.bind(this,-this.step)}}),e("span",{style:"font-size:14px;"},[this.scaleVal,"%"]),e("i",{class:"btn  el-icon-plus ",on:{click:this.changeScale.bind(this,this.step)}})]),e(V,{attrs:{verifyMode:this.verifyMode,data:this.data},key:this.updateId,on:{emits:this.eventReciver},style:{transform:"scale(".concat(this.scaleVal/100,")")}}),e(De,{attrs:{value:this.activeData,processData:this.data},on:{confirm:this.onPropEditConfirm,cancel:this.onClosePanel}})])}},Oe=_e,Se=(n("aa9c"),Object(a["a"])(Oe,Q,X,!1,null,"662402f7",null)),Ie=Se.exports,Te=function(e,t){var n;return function(){var i=arguments,o=this;n&&clearTimeout(n),n=setTimeout((function(){e.apply(o,i)}),t)}},Ee=function(e,t){var n={},i=e.reduce((function(e,i){return!n[i[t]]&&(n[i[t]]=e.push(i)),e}),[]);return i},Ke={name:"Home",components:{Process:Ie},data:function(){return{processLoading:!1,mockData:null,fieldArr:[]}},mounted:function(){this.initData()},methods:{getCondition:function(e){var t=this;e.conditionNodes&&e.conditionNodes.forEach((function(e){e.conditionConfigs&&(t.fieldArr=t.setFieldArr(e.conditionConfigs,t.fieldArr)),e.conditionNodes&&t.getCondition(e),e.childNode&&t.getCondition(e.childNode)})),e.childNode&&this.getCondition(e.childNode)},setFieldArr:function(e,t){return e.forEach((function(e){var n={field:e.field,fieldName:e.fieldName,fieldType:e.fieldType};t.push(n)})),t},initData:function(){var e=this;return Object(p["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.processLoading=!0,n=window.ccAccountbookId,i=window.ccBillType,!n||!i){t.next=8;break}return t.next=6,e.getFlowData(n,i);case 6:t.next=9;break;case 8:e.$message.error("accountbookId或billType不存在");case 9:case"end":return t.stop()}}),t)})))()},getFlowData:function(e,t){var n=this;ee(e,t).then((function(e){if(console.log("res-approver",e),""!=e.data){var t=JSON.parse(e.data);n.mockData=t}else n.mockData={};n.processLoading=!1}))},onStartChange:function(e){console.log("监听 流程节点发起人改变 并同步到基础设置 发起人数据",e)},publish:function(){var e=this,t=function(t){return e.$refs[t].getData()},n=t("processDesign");Promise.all([n]).then((function(t){var n={processData:t[0].formData};e.fieldArr=[],e.getCondition(n.processData);var i=Ee(e.fieldArr,"field");n.processData.conditionField=i,e.sendToServer(n)})).catch((function(t){t.target&&(e.activeStep=t.target),t.target&&(e.activeStep=t.target,e.$message.error("审批流程存在错误的节点，请检查标记为红色的节点，修复后再试")),t.msg&&e.$message.warning(t.msg)}))},sendToServer:function(e){var t=this;console.log("配置数据",e),this.processLoading=!0;var n=window.ccAccountbookId,i=window.ccBillType;console.log("eee",i),ne(n,i,e).then((function(e){t.processLoading=!1,t.$message({type:e.data.success?"success":"error",message:e.data.msg,center:!0})}))}}},$e=Ke,Pe=(n("22b4"),Object(a["a"])($e,u,h,!1,null,"24bb53bd",null)),Le=Pe.exports;i["default"].use(d["a"]);var Ae=[{path:"/",name:"approver",component:Le}],je=new d["a"]({base:"",routes:Ae}),Me=je,Be=n("2f62");i["default"].use(Be["a"]);var Fe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.processConditions.findIndex((function(e){return e.formId===t}));return n?i:i>-1},Ve=new Be["a"].Store({state:{processConditions:[],formItemList:[]},mutations:{initPConditions:function(e,t){e.processConditions=t},addPCondition:function(e,t){null!==t.formId&&void 0!==t.formId&&(Fe(e,t.formId)||e.processConditions.unshift(t))},delPCondition:function(e,t){if(null!==t&&void 0!==t){var n=Fe(e,t,!0),i=e.processConditions;n>-1&&i.splice(n,1)}},clearPCondition:function(e){e.processConditions=[]},updateFormItemList:function(e,t){e.formItemList=t}}}),Re=Ve,ze=(n("0fae"),n("b0c0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("section",{staticClass:"h-transfer",class:[1==e.tabConfig.length?"single-tab":""]},[n("div",{staticClass:"mask"}),n("div",{staticClass:"transfer__content"},[n("header",{staticClass:"transfer__header"},[n("i",{staticClass:"el-icon-monitor"}),e._v(" "+e._s(e.title)+" "),n("i",{staticClass:"el-icon-close",on:{click:e.closeTransfer}})]),n("div",{staticClass:"transfer__body"},[n("div",{staticClass:"transfer-pane"},[n("div",{staticClass:"transfer-pane__tools"},[n("el-input",{staticClass:"search-input",staticStyle:{width:"180px"},attrs:{size:"mini",type:"search",placeholder:"搜索...",disabled:!e.searchable},model:{value:e.searchString,callback:function(t){e.searchString=t},expression:"searchString"}}),n("span",[n("span",{staticStyle:{"margin-right":"1rem","font-size":"14px"}},[e._v(e._s(e.selectedNum)+" / "+e._s(e.maxNum))]),n("el-tooltip",{attrs:{placement:"top",content:"清空"}},[n("i",{staticClass:"el-icon-delete",on:{click:e.removeAll}})])],1)],1),n("el-scrollbar",{staticClass:"transfer-pane__body shadow right-pane"},[e._l(e.tabKeys,(function(t){return e._l(e.selectedData[t],(function(i,o){return n("div",{key:t+o,staticClass:"selected-item"},[n("span",[n("span",[e._v(e._s(e.getNodeProp(i,"label")))])]),n("i",{staticClass:"el-icon-delete",on:{click:function(n){return e.removeData(i,t)}}})])}))})),e._l(e.tabKeys,(function(t){return e._l(e.aloneCheckedData[t],(function(i,o){return n("div",{key:"alone"+t+o,staticClass:"selected-item"},[n("span",[n("span",[e._v(e._s(e.getNodeProp(i,"label")))])]),n("i",{staticClass:"el-icon-delete",on:{click:function(n){return e.removeData(i,t,!0)}}})])}))}))],2),n("footer",{staticClass:"transfer__footer"},[n("el-button",{attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.confirm}},[e._v("确定")]),n("el-button",{attrs:{plain:"",size:"mini"},on:{click:e.closeTransfer}},[e._v("取消")])],1)],1),n("div",{staticClass:"transfer-pane"},[n("div",{staticClass:"transfer-pane__body",staticStyle:{height:"370px"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isEnough,expression:"isEnough"}],staticClass:"enough-mask"},[n("span",{staticClass:"p-center"},[e._v("最多选择"+e._s(e.maxNum)+"项")])]),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.searchLoading,expression:"searchLoading"}],staticClass:"searchResPane",class:{active:e.searchMode}},[n("div",{staticClass:"hidden-tag",on:{click:function(t){e.searchString=""}}},[e._v("关闭")]),1==e.tabConfig.length&&"role"==e.activeTabName?n("div",e._l(e.searchRes,(function(t,i){return n("div",{key:i,staticClass:"item",on:{click:function(n){return e.handleNodeClick(t)}}},[n("div",[n("div",[e._v(e._s(e.getNodeProp(t,"label")))])])])})),0):n("div",e._l(e.searchRes,(function(t,i){return n("div",{key:i,staticClass:"item",on:{click:function(n){return e.searchItemClick(t)}}},[n("div",[n("div",[e._v(e._s(e.getNodeProp(t,"label")))]),n("div",{staticClass:"text-ellipsis search-res-tip"},[e._v(" "+e._s(e.getNodeProp(t,"searchResTip"))+" ")])]),n("el-checkbox",{on:{change:function(n){return n?e.addData(t):e.removeData(t,e.activeTabName,!0)}},nativeOn:{click:function(e){e.stopPropagation()}},model:{value:t.checked,callback:function(n){e.$set(t,"checked",n)},expression:"item.checked"}})],1)})),0)]),n("el-scrollbar",{staticStyle:{height:"100%"}},[n("el-tabs",{staticStyle:{"min-height":"370px"},attrs:{type:"border-card"},model:{value:e.activeTabName,callback:function(t){e.activeTabName=t},expression:"activeTabName"}},e._l(e.tabConfig,(function(t,i){return n("el-tab-pane",{key:i,attrs:{name:t.tabKey,label:t.tabName}},[n("el-tree",{ref:t.tabKey,refInFor:!0,attrs:{lazy:"","show-checkbox":1!=e.tabConfig.length||"role"!=t.tabKey,props:{children:t.children,label:t.label,isLeaf:t.isLeaf,disabled:t.disabled},load:function(n,i){return e.onLoad(n,i,t.tabKey)},"node-key":"nodeId","check-strictly":!0},on:{"node-click":e.handleNodeClick,"check-change":function(n,i){return e.onCheckChange(n,i,t.tabKey)}}})],1)})),1)],1)],1)])])])]):e._e()}),qe=[],Ue=n("3835");n("a9e3"),n("5319");function Je(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}window.ccBillType=Je("billType"),window.ccAccountbookId=Je("accountbookId");var He=window.ccAccountbookId;console.log("accout",He);function Ge(){return We.apply(this,arguments)}function We(){return We=Object(p["a"])(regeneratorRuntime.mark((function e(){var t,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[ie(He)],n=[],e.prev=2,e.next=5,Promise.all(t);case 5:n=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](2);case 10:return i=n.reduce((function(e,t){return[].concat(Object(f["a"])(e),Object(f["a"])(t.data))}),[]),e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,null,[[2,8]])}))),We.apply(this,arguments)}function Ye(e){return Qe.apply(this,arguments)}function Qe(){return Qe=Object(p["a"])(regeneratorRuntime.mark((function e(t){var n,i,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=[oe(t)],i=[],e.prev=2,e.next=5,Promise.all(n);case 5:i=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](2);case 10:return o=i.reduce((function(e,t){return[].concat(Object(f["a"])(e),Object(f["a"])(t.data))}),[]),e.abrupt("return",o);case 12:case"end":return e.stop()}}),e,null,[[2,8]])}))),Qe.apply(this,arguments)}function Xe(e){return Ze.apply(this,arguments)}function Ze(){return Ze=Object(p["a"])(regeneratorRuntime.mark((function e(t){var n,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(i.length>1&&void 0!==i[1])||i[1],n=[],0!==t.level){e.next=8;break}return e.next=5,Ge();case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,Ye(t.data.id);case 10:n=e.sent;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)}))),Ze.apply(this,arguments)}function et(e){return Xe(e)}function tt(e){return Xe(e,!1)}function nt(){return it.apply(this,arguments)}function it(){return it=Object(p["a"])(regeneratorRuntime.mark((function e(){var t,n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=[ae({accountbookId:He})],n=[],e.prev=2,e.next=5,Promise.all(t);case 5:n=e.sent,e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](2);case 10:return i=n.reduce((function(e,t){return[].concat(Object(f["a"])(e),Object(f["a"])(t.data))}),[]),e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,null,[[2,8]])}))),it.apply(this,arguments)}function ot(e){return rt.apply(this,arguments)}function rt(){return rt=Object(p["a"])(regeneratorRuntime.mark((function e(t){var n,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return!(i.length>1&&void 0!==i[1])||i[1],n=[],e.next=4,nt();case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)}))),rt.apply(this,arguments)}function at(e){return ot(e,!1)}var st={tabName:"部门",tabKey:"dep",children:"children",nodeId:function(e){return e.id},label:function(e,t){return e.hasOwnProperty("realName")?e.realName:e.name},isLeaf:function(e,t){return e.hasOwnProperty("realName")},searchResTip:function(e){return"部门："+e.departName},disabled:function(e,t){return!1},onload:et,onsearch:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(t,n,i){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,re(He,t);case 2:o=e.sent,n(o.data);case 4:case"end":return e.stop()}}),e)})));function t(t,n,i){return e.apply(this,arguments)}return t}()},ct={tabName:"职级",tabKey:"role",children:"children",nodeId:function(e){return e.id},label:function(e,t){return e.hasOwnProperty("realName")?e.realName:e.name},isLeaf:function(e,t){return e.hasOwnProperty("id")},onload:at,onsearch:function(){var e=Object(p["a"])(regeneratorRuntime.mark((function e(t,n,i){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ae({accountbookId:He,name:t});case 2:o=e.sent,n(o.data);case 4:case"end":return e.stop()}}),e)})));function t(t,n,i){return e.apply(this,arguments)}return t}()},lt=Object.assign({},st),dt=Object.assign({},ct),ut=Object.assign({},st,{tabKey:"user",tabName:"指定人员",onload:tt,disabled:function(e,t){return!e.hasOwnProperty("realName")}}),ht=Object.assign({},st,{tabKey:"dep&user",tabName:"部门和人员",onload:tt,disabled:function(){return!1}}),pt=[lt,ut,ht,dt],ft=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"el-tree",class:{"el-tree--highlight-current":e.highlightCurrent,"is-dragging":!!e.dragState.draggingNode,"is-drop-not-allow":!e.dragState.allowDrop,"is-drop-inner":"inner"===e.dragState.dropType},attrs:{role:"tree"}},[e._l(e.root.childNodes,(function(t){return n("el-tree-node",{key:e.getNodeKey(t),attrs:{node:t,props:e.props,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent},on:{"node-expand":e.handleNodeExpand}})})),e.isEmpty?n("div",{staticClass:"el-tree__empty-block"},[n("span",{staticClass:"el-tree__empty-text"},[e._v(e._s(e.emptyText))])]):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.dragState.showDropIndicator,expression:"dragState.showDropIndicator"}],ref:"dropIndicator",staticClass:"el-tree__drop-indicator"})],2)},vt=[],yt=n("ade3"),gt=(n("07ac"),n("eab7")),mt="$treeNodeId",bt=function(e,t){t&&!t[mt]&&Object.defineProperty(t,mt,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},kt=function(e,t){return e?t[e]:t[mt]},Nt=function(e,t){var n=e;while(n&&"BODY"!==n.tagName){if(n.__vue__&&n.__vue__.$options.name===t)return n.__vue__;n=n.parentNode}return null},Ct=n("6bd7"),xt=function(e){for(var t=!0,n=!0,i=!0,o=0,r=e.length;o<r;o++){var a=e[o];(!0!==a.checked||a.indeterminate)&&(t=!1,a.disabled||(i=!1)),(!1!==a.checked||a.indeterminate)&&(n=!1)}return{all:t,none:n,allWithoutDisable:i,half:!t&&!n}},wt=function e(t){if(0!==t.childNodes.length){var n=xt(t.childNodes),i=n.all,o=n.none,r=n.half;i?(t.checked=!0,t.indeterminate=!1):r?(t.checked=!1,t.indeterminate=!0):o&&(t.checked=!1,t.indeterminate=!1);var a=t.parent;a&&0!==a.level&&(t.store.checkStrictly||e(a))}},Dt=function(e,t){var n=e.store.props,i=e.data||{},o=n[t];if("function"===typeof o)return o(i,e);if("string"===typeof o)return i[o];if("undefined"===typeof o){var r=i[t];return void 0===r?"":r}},_t=0,Ot=function(){function e(t){for(var n in Object(b["a"])(this,e),this.id=_t++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,t)t.hasOwnProperty(n)&&(this[n]=t[n]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1);var i=this.store;if(!i)throw new Error("[Node]store is required!");i.registerNode(this);var o=i.props;if(o&&"undefined"!==typeof o.isLeaf){var r=Dt(this,"isLeaf");"boolean"===typeof r&&(this.isLeafByUser=r)}if(!0!==i.lazy&&this.data?(this.setData(this.data),i.defaultExpandAll&&(this.expanded=!0)):this.level>0&&i.lazy&&i.defaultExpandAll&&this.expand(),Array.isArray(this.data)||bt(this,this.data),this.data){var a=i.defaultExpandedKeys,s=i.key;s&&a&&-1!==a.indexOf(this.key)&&this.expand(null,i.autoExpandParent),s&&void 0!==i.currentNodeKey&&this.key===i.currentNodeKey&&(i.currentNode=this,i.currentNode.isCurrent=!0),i.lazy&&i._initDefaultCheckedNode(this),this.updateLeafState()}}return Object(k["a"])(e,[{key:"setData",value:function(e){var t;Array.isArray(e)||bt(this,e),this.data=e,this.childNodes=[],t=0===this.level&&this.data instanceof Array?this.data:Dt(this,"children")||[];for(var n=0,i=t.length;n<i;n++)this.insertChild({data:t[n]})}},{key:"label",get:function(){return Dt(this,"label")}},{key:"key",get:function(){var e=this.store.key;return this.data?this.data[e]:null}},{key:"disabled",get:function(){return Dt(this,"disabled")}},{key:"nextSibling",get:function(){var e=this.parent;if(e){var t=e.childNodes.indexOf(this);if(t>-1)return e.childNodes[t+1]}return null}},{key:"previousSibling",get:function(){var e=this.parent;if(e){var t=e.childNodes.indexOf(this);if(t>-1)return t>0?e.childNodes[t-1]:null}return null}},{key:"contains",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function n(i){for(var o=i.childNodes||[],r=!1,a=0,s=o.length;a<s;a++){var c=o[a];if(c===e||t&&n(c)){r=!0;break}}return r};return n(this)}},{key:"remove",value:function(){var e=this.parent;e&&e.removeChild(this)}},{key:"insertChild",value:function(t,n,i){if(!t)throw new Error("insertChild error: child is required.");if(!(t instanceof e)){if(!i){var o=this.getChildren(!0)||[];-1===o.indexOf(t.data)&&("undefined"===typeof n||n<0?o.push(t.data):o.splice(n,0,t.data))}Object(gt["a"])(t,{parent:this,store:this.store}),t=new e(t)}t.level=this.level+1,"undefined"===typeof n||n<0?this.childNodes.push(t):this.childNodes.splice(n,0,t),this.updateLeafState()}},{key:"insertBefore",value:function(e,t){var n;t&&(n=this.childNodes.indexOf(t)),this.insertChild(e,n)}},{key:"insertAfter",value:function(e,t){var n;t&&(n=this.childNodes.indexOf(t),-1!==n&&(n+=1)),this.insertChild(e,n)}},{key:"removeChild",value:function(e){var t=this.getChildren()||[],n=t.indexOf(e.data);n>-1&&t.splice(n,1);var i=this.childNodes.indexOf(e);i>-1&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(i,1)),this.updateLeafState()}},{key:"removeChildByData",value:function(e){for(var t=null,n=0;n<this.childNodes.length;n++)if(this.childNodes[n].data===e){t=this.childNodes[n];break}t&&this.removeChild(t)}},{key:"expand",value:function(e,t){var n=this,i=function(){if(t){var i=n.parent;while(i.level>0)i.expanded=!0,i=i.parent}n.expanded=!0,e&&e()};this.shouldLoadData()?this.loadData((function(e){e instanceof Array&&(n.checked?n.setChecked(!0,!0):n.store.checkStrictly||wt(n),i())})):i()}},{key:"doCreateChildren",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e){t.insertChild(Object(gt["a"])({data:e},n),void 0,!0)}))}},{key:"collapse",value:function(){this.expanded=!1}},{key:"shouldLoadData",value:function(){return!0===this.store.lazy&&this.store.load&&!this.loaded}},{key:"updateLeafState",value:function(){if(!0!==this.store.lazy||!0===this.loaded||"undefined"===typeof this.isLeafByUser){var e=this.childNodes;!this.store.lazy||!0===this.store.lazy&&!0===this.loaded?this.isLeaf=!e||0===e.length:this.isLeaf=!1}else this.isLeaf=this.isLeafByUser}},{key:"setChecked",value:function(e,t,n,i){var o=this;if(this.indeterminate="half"===e,this.checked=!0===e,!this.store.checkStrictly){if(!this.shouldLoadData()||this.store.checkDescendants){var r=xt(this.childNodes),a=r.all,s=r.allWithoutDisable;this.isLeaf||a||!s||(this.checked=!1,e=!1);var c=function(){if(t){for(var n=o.childNodes,r=0,a=n.length;r<a;r++){var s=n[r];i=i||!1!==e;var c=s.disabled?s.checked:i;s.setChecked(c,t,!0,i)}var l=xt(n),d=l.half,u=l.all;u||(o.checked=u,o.indeterminate=d)}};if(this.shouldLoadData())return void this.loadData((function(){c(),wt(o)}),{checked:!1!==e});c()}var l=this.parent;l&&0!==l.level&&(n||wt(l))}}},{key:"getChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(0===this.level)return this.data;var t=this.data;if(!t)return null;var n=this.store.props,i="children";return n&&(i=n.children||"children"),void 0===t[i]&&(t[i]=null),e&&!t[i]&&(t[i]=[]),t[i]}},{key:"updateChildren",value:function(){var e=this,t=this.getChildren()||[],n=this.childNodes.map((function(e){return e.data})),i={},o=[];t.forEach((function(e,t){var r=e[mt],a=!!r&&Object(Ct["a"])(n,(function(e){return e[mt]===r}))>=0;a?i[r]={index:t,data:e}:o.push({index:t,data:e})})),this.store.lazy||n.forEach((function(t){i[t[mt]]||e.removeChildByData(t)})),o.forEach((function(t){var n=t.index,i=t.data;e.insertChild({data:i},n)})),this.updateLeafState()}},{key:"loadData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!0!==this.store.lazy||!this.store.load||this.loaded||this.loading&&!Object.keys(n).length)e&&e.call(this);else{this.loading=!0;var i=function(i){t.loaded=!0,t.loading=!1,t.childNodes=[],t.doCreateChildren(i,n),t.updateLeafState(),e&&e.call(t,i)};this.store.load(this,i)}}}]),e}(),St=function(){function e(t){var n=this;for(var i in Object(b["a"])(this,e),this.currentNode=null,this.currentNodeKey=null,t)t.hasOwnProperty(i)&&(this[i]=t[i]);if(this.nodesMap={},this.myNodesMap=[],this.root=new Ot({data:this.data,store:this}),this.lazy&&this.load){var o=this.load;o(this.root,(function(e){n.root.doCreateChildren(e),n._initDefaultCheckedNodes()}))}else this._initDefaultCheckedNodes()}return Object(k["a"])(e,[{key:"setMyChecked",value:function(e,t,n){var i=this.getMyNode(e);if(i&&i.length>0)for(var o=0;o<i.length;o++){var r=i[o],a=Object.values(r)[0];a&&a.checked!==t&&a.setChecked(!!t,n)}}},{key:"getMyNode",value:function(e){var t="object"!==Object(v["a"])(e)?e:kt(this.key,e),n=this.myNodesMap.filter((function(e){return e[t]}));return n||[]}},{key:"filter",value:function(e){var t=this.filterNodeMethod,n=this.lazy,i=function i(o){var r=o.root?o.root.childNodes:o.childNodes;if(r.forEach((function(n){n.visible=t.call(n,e,n.data,n),i(n)})),!o.visible&&r.length){var a=!0;a=!r.some((function(e){return e.visible})),o.root?o.root.visible=!1===a:o.visible=!1===a}e&&(!o.visible||o.isLeaf||n||o.expand())};i(this)}},{key:"setData",value:function(e){var t=e!==this.root.data;t?(this.root.setData(e),this._initDefaultCheckedNodes()):this.root.updateChildren()}},{key:"getNode",value:function(e){if(e instanceof Ot)return e;var t="object"!==Object(v["a"])(e)?e:kt(this.key,e);return this.nodesMap[t]||null}},{key:"insertBefore",value:function(e,t){var n=this.getNode(t);n.parent.insertBefore({data:e},n)}},{key:"insertAfter",value:function(e,t){var n=this.getNode(t);n.parent.insertAfter({data:e},n)}},{key:"remove",value:function(e){var t=this.getNode(e);t&&t.parent&&(t===this.currentNode&&(this.currentNode=null),t.parent.removeChild(t))}},{key:"append",value:function(e,t){var n=t?this.getNode(t):this.root;n&&n.insertChild({data:e})}},{key:"_initDefaultCheckedNodes",value:function(){var e=this,t=this.defaultCheckedKeys||[],n=this.nodesMap;t.forEach((function(t){var i=n[t];i&&i.setChecked(!0,!e.checkStrictly)}))}},{key:"_initDefaultCheckedNode",value:function(e){var t=this.defaultCheckedKeys||[];-1!==t.indexOf(e.key)&&e.setChecked(!0,!this.checkStrictly)}},{key:"setDefaultCheckedKey",value:function(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())}},{key:"registerNode",value:function(e){var t=this.key;if(t&&e&&e.data){var n=e.key;void 0!==n&&(this.nodesMap[e.key]=e),void 0!==n&&this.myNodesMap.push(Object(yt["a"])({},e.key,e))}}},{key:"deregisterNode",value:function(e){var t=this,n=this.key;n&&e&&e.data&&(e.childNodes.forEach((function(e){t.deregisterNode(e)})),delete this.nodesMap[e.key])}},{key:"getCheckedNodes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],i=function i(o){var r=o.root?o.root.childNodes:o.childNodes;r.forEach((function(o){(o.checked||t&&o.indeterminate)&&(!e||e&&o.isLeaf)&&n.push(o.data),i(o)}))};return i(this),n}},{key:"getCheckedKeys",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.getCheckedNodes(t).map((function(t){return(t||{})[e.key]}))}},{key:"getHalfCheckedNodes",value:function(){var e=[],t=function t(n){var i=n.root?n.root.childNodes:n.childNodes;i.forEach((function(n){n.indeterminate&&e.push(n.data),t(n)}))};return t(this),e}},{key:"getHalfCheckedKeys",value:function(){var e=this;return this.getHalfCheckedNodes().map((function(t){return(t||{})[e.key]}))}},{key:"_getAllNodes",value:function(){var e=[],t=this.nodesMap;for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e}},{key:"updateChildren",value:function(e,t){var n=this.nodesMap[e];if(n){for(var i=n.childNodes,o=i.length-1;o>=0;o--){var r=i[o];this.remove(r.data)}for(var a=0,s=t.length;a<s;a++){var c=t[a];this.append(c,n.data)}}}},{key:"_setCheckedKeys",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,i=this._getAllNodes().sort((function(e,t){return t.level-e.level})),o=Object.create(null),r=Object.keys(n);i.forEach((function(e){return e.setChecked(!1,!1)}));for(var a=0,s=i.length;a<s;a++){var c=i[a],l=c.data[e].toString(),d=r.indexOf(l)>-1;if(d){var u=c.parent;while(u&&u.level>0)o[u.data[e]]=!0,u=u.parent;c.isLeaf||this.checkStrictly?c.setChecked(!0,!1):(c.setChecked(!0,!0),t&&function(){c.setChecked(!1,!1);var e=function e(t){var n=t.childNodes;n.forEach((function(t){t.isLeaf||t.setChecked(!1,!1),e(t)}))};e(c)}())}else c.checked&&!o[l]&&c.setChecked(!1,!1)}}},{key:"setCheckedNodes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.key,i={};e.forEach((function(e){i[(e||{})[n]]=!0})),this._setCheckedKeys(n,t,i)}},{key:"setCheckedKeys",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.defaultCheckedKeys=e;var n=this.key,i={};e.forEach((function(e){i[e]=!0})),this._setCheckedKeys(n,t,i)}},{key:"setDefaultExpandedKeys",value:function(e){var t=this;e=e||[],this.defaultExpandedKeys=e,e.forEach((function(e){var n=t.getNode(e);n&&n.expand(null,t.autoExpandParent)}))}},{key:"setChecked",value:function(e,t,n){var i=this.getNode(e);i&&i.setChecked(!!t,n)}},{key:"getCurrentNode",value:function(){return this.currentNode}},{key:"setCurrentNode",value:function(e){var t=this.currentNode;t&&(t.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0}},{key:"setUserCurrentNode",value:function(e){var t=e[this.key],n=this.nodesMap[t];this.setCurrentNode(n)}},{key:"setCurrentNodeKey",value:function(e){if(null===e||void 0===e)return this.currentNode&&(this.currentNode.isCurrent=!1),void(this.currentNode=null);var t=this.getNode(e);t&&this.setCurrentNode(t)}}]),e}(),It=function(){var e=this,t=this,n=t.$createElement,i=t._self._c||n;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.node.visible,expression:"node.visible"}],ref:"node",staticClass:"el-tree-node",class:{"is-expanded":t.expanded,"is-current":t.node.isCurrent,"is-hidden":!t.node.visible,"is-focusable":!t.node.disabled,"is-checked":!t.node.disabled&&t.node.checked},attrs:{role:"treeitem",tabindex:"-1","aria-expanded":t.expanded,"aria-disabled":t.node.disabled,"aria-checked":t.node.checked,draggable:t.tree.draggable},on:{click:function(e){return e.stopPropagation(),t.handleClick(e)},contextmenu:function(t){return e.handleContextMenu(t)},dragstart:function(e){return e.stopPropagation(),t.handleDragStart(e)},dragover:function(e){return e.stopPropagation(),t.handleDragOver(e)},dragend:function(e){return e.stopPropagation(),t.handleDragEnd(e)},drop:function(e){return e.stopPropagation(),t.handleDrop(e)}}},[i("div",{staticClass:"el-tree-node__content",style:{"padding-left":(t.node.level-1)*t.tree.indent+"px"}},[i("span",{class:[{"is-leaf":t.node.isLeaf,expanded:!t.node.isLeaf&&t.expanded},"el-tree-node__expand-icon",t.tree.iconClass?t.tree.iconClass:"el-icon-caret-right"],on:{click:function(e){return e.stopPropagation(),t.handleExpandIconClick(e)}}}),t.showCheckbox?i("el-checkbox",{attrs:{indeterminate:t.node.indeterminate,disabled:!!t.node.disabled},on:{change:t.handleCheckChange},nativeOn:{click:function(e){e.stopPropagation()}},model:{value:t.node.checked,callback:function(e){t.$set(t.node,"checked",e)},expression:"node.checked"}}):t._e(),t.node.loading?i("span",{staticClass:"el-tree-node__loading-icon el-icon-loading"}):t._e(),i("node-content",{attrs:{node:t.node}})],1),i("el-collapse-transition",[!t.renderAfterExpand||t.childNodeRendered?i("div",{directives:[{name:"show",rawName:"v-show",value:t.expanded,expression:"expanded"}],staticClass:"el-tree-node__children",attrs:{role:"group","aria-expanded":t.expanded}},t._l(t.node.childNodes,(function(e){return i("el-tree-node",{key:t.getNodeKey(e),attrs:{"render-content":t.renderContent,"render-after-expand":t.renderAfterExpand,"show-checkbox":t.showCheckbox,node:e},on:{"node-expand":t.handleChildNodeExpand}})})),1):t._e()])],1)},Tt=[],Et=n("f308"),Kt=n("9c1a"),$t=n("f6f4"),Pt={name:"ElTreeNode",componentName:"ElTreeNode",mixins:[$t["a"]],props:{node:{default:function(){return{}}},props:{},renderContent:Function,renderAfterExpand:{type:Boolean,default:!0},showCheckbox:{type:Boolean,default:!1}},components:{ElCollapseTransition:Et["a"],ElCheckbox:Kt["a"],NodeContent:{props:{node:{required:!0}},render:function(e){var t=this.$parent,n=t.tree,i=this.node,o=i.data,r=i.store;return t.renderContent?t.renderContent.call(t._renderProxy,e,{_self:n.$vnode.context,node:i,data:o,store:r}):n.$scopedSlots.default?n.$scopedSlots.default({node:i,data:o}):e("span",{class:"el-tree-node__label"},[i.label])}}},data:function(){return{tree:null,expanded:!1,childNodeRendered:!1,oldChecked:null,oldIndeterminate:null}},watch:{"node.indeterminate":function(e){this.handleSelectChange(this.node.checked,e)},"node.checked":function(e){this.handleSelectChange(e,this.node.indeterminate)},"node.expanded":function(e){var t=this;this.$nextTick((function(){return t.expanded=e})),e&&(this.childNodeRendered=!0)}},methods:{getNodeKey:function(e){return kt(this.tree.nodeKey,e.data)},handleSelectChange:function(e,t){this.oldChecked!==e&&this.oldIndeterminate!==t&&this.tree.$emit("check-change",this.node.data,e,t),this.oldChecked=e,this.indeterminate=t},handleClick:function(){var e=this.tree.store;e.setCurrentNode(this.node),this.tree.$emit("current-change",e.currentNode?e.currentNode.data:null,e.currentNode),this.tree.currentNode=this,this.tree.expandOnClickNode&&this.handleExpandIconClick(),this.tree.checkOnClickNode&&!this.node.disabled&&this.handleCheckChange(null,{target:{checked:!this.node.checked}}),this.tree.$emit("node-click",this.node.data,this.node,this)},handleContextMenu:function(e){this.tree._events["node-contextmenu"]&&this.tree._events["node-contextmenu"].length>0&&(e.stopPropagation(),e.preventDefault()),this.tree.$emit("node-contextmenu",e,this.node.data,this.node,this)},handleExpandIconClick:function(){this.node.isLeaf||(this.expanded?(this.tree.$emit("node-collapse",this.node.data,this.node,this),this.node.collapse()):(this.node.expand(),this.$emit("node-expand",this.node.data,this.node,this)))},handleCheckChange:function(e,t){var n=this;this.node.setChecked(t.target.checked,!this.tree.checkStrictly),this.$nextTick((function(){var e=n.tree.store;n.tree.$emit("check",n.node.data,{checkedNodes:e.getCheckedNodes(),checkedKeys:e.getCheckedKeys(),halfCheckedNodes:e.getHalfCheckedNodes(),halfCheckedKeys:e.getHalfCheckedKeys()})}))},handleChildNodeExpand:function(e,t,n){this.broadcast("ElTreeNode","tree-node-expand",t),this.tree.$emit("node-expand",e,t,n)},handleDragStart:function(e){this.tree.draggable&&this.tree.$emit("tree-node-drag-start",e,this)},handleDragOver:function(e){this.tree.draggable&&(this.tree.$emit("tree-node-drag-over",e,this),e.preventDefault())},handleDrop:function(e){e.preventDefault()},handleDragEnd:function(e){this.tree.draggable&&this.tree.$emit("tree-node-drag-end",e,this)}},created:function(){var e=this,t=this.$parent;t.isTree?this.tree=t:this.tree=t.tree;var n=this.tree;n||console.warn("Can not find node's tree.");var i=n.props||{},o=i["children"]||"children";this.$watch("node.data.".concat(o),(function(){e.node.updateChildren()})),this.node.expanded&&(this.expanded=!0,this.childNodeRendered=!0),this.tree.accordion&&this.$on("tree-node-expand",(function(t){e.node!==t&&e.node.collapse()}))}},Lt=Pt,At=Object(a["a"])(Lt,It,Tt,!1,null,null,null),jt=At.exports,Mt=n("9206"),Bt=n("526f"),Ft={name:"ElTree",mixins:[$t["a"]],components:{ElTreeNode:jt},data:function(){return{store:null,root:null,currentNode:null,treeItems:null,checkboxItems:[],dragState:{showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0}}},props:{data:{type:Array},emptyText:{type:String,default:function(){return Object(Mt["a"])("el.tree.emptyText")}},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{default:function(){return{children:"children",label:"label",disabled:"disabled"}}},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},iconClass:String},computed:{children:{set:function(e){this.data=e},get:function(){return this.data}},treeItemArray:function(){return Array.prototype.slice.call(this.treeItems)},isEmpty:function(){var e=this.root.childNodes;return!e||0===e.length||e.every((function(e){var t=e.visible;return!t}))}},watch:{defaultCheckedKeys:function(e){this.store.setDefaultCheckedKey(e)},defaultExpandedKeys:function(e){this.store.defaultExpandedKeys=e,this.store.setDefaultExpandedKeys(e)},data:function(e){this.store.setData(e)},checkboxItems:function(e){Array.prototype.forEach.call(e,(function(e){e.setAttribute("tabindex",-1)}))},checkStrictly:function(e){this.store.checkStrictly=e}},methods:{filter:function(e){if(!this.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");this.store.filter(e)},getNodeKey:function(e){return kt(this.nodeKey,e.data)},getNodePath:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");var t=this.store.getNode(e);if(!t)return[];var n=[t.data],i=t.parent;while(i&&i!==this.root)n.push(i.data),i=i.parent;return n.reverse()},getCheckedNodes:function(e,t){return this.store.getCheckedNodes(e,t)},getCheckedKeys:function(e){return this.store.getCheckedKeys(e)},getCurrentNode:function(){var e=this.store.getCurrentNode();return e?e.data:null},getCurrentKey:function(){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");var e=this.getCurrentNode();return e?e[this.nodeKey]:null},setCheckedNodes:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");this.store.setCheckedNodes(e,t)},setCheckedKeys:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");this.store.setCheckedKeys(e,t)},setChecked:function(e,t,n){this.store.setChecked(e,t,n)},setMyChecked:function(e,t,n){this.store.setMyChecked(e,t,n)},getHalfCheckedNodes:function(){return this.store.getHalfCheckedNodes()},getHalfCheckedKeys:function(){return this.store.getHalfCheckedKeys()},setCurrentNode:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");this.store.setUserCurrentNode(e)},setCurrentKey:function(e){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");this.store.setCurrentNodeKey(e)},getNode:function(e){return this.store.getNode(e)},remove:function(e){this.store.remove(e)},append:function(e,t){this.store.append(e,t)},insertBefore:function(e,t){this.store.insertBefore(e,t)},insertAfter:function(e,t){this.store.insertAfter(e,t)},handleNodeExpand:function(e,t,n){this.broadcast("ElTreeNode","tree-node-expand",t),this.$emit("node-expand",e,t,n)},updateKeyChildren:function(e,t){if(!this.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");this.store.updateChildren(e,t)},initTabIndex:function(){this.treeItems=this.$el.querySelectorAll(".is-focusable[role=treeitem]"),this.checkboxItems=this.$el.querySelectorAll("input[type=checkbox]");var e=this.$el.querySelectorAll(".is-checked[role=treeitem]");e.length?e[0].setAttribute("tabindex",0):this.treeItems[0]&&this.treeItems[0].setAttribute("tabindex",0)},handleKeydown:function(e){var t=e.target;if(-1!==t.className.indexOf("el-tree-node")){var n=e.keyCode;this.treeItems=this.$el.querySelectorAll(".is-focusable[role=treeitem]");var i,o=this.treeItemArray.indexOf(t);[38,40].indexOf(n)>-1&&(e.preventDefault(),i=38===n?0!==o?o-1:0:o<this.treeItemArray.length-1?o+1:0,this.treeItemArray[i].focus()),[37,39].indexOf(n)>-1&&(e.preventDefault(),t.click());var r=t.querySelector('[type="checkbox"]');[13,32].indexOf(n)>-1&&r&&(e.preventDefault(),r.click())}}},created:function(){var e=this;this.isTree=!0,this.store=new St({key:this.nodeKey,data:this.data,lazy:this.lazy,props:this.props,load:this.load,currentNodeKey:this.currentNodeKey,checkStrictly:this.checkStrictly,checkDescendants:this.checkDescendants,defaultCheckedKeys:this.defaultCheckedKeys,defaultExpandedKeys:this.defaultExpandedKeys,autoExpandParent:this.autoExpandParent,defaultExpandAll:this.defaultExpandAll,filterNodeMethod:this.filterNodeMethod}),this.root=this.store.root;var t=this.dragState;this.$on("tree-node-drag-start",(function(n,i){if("function"===typeof e.allowDrag&&!e.allowDrag(i.node))return n.preventDefault(),!1;n.dataTransfer.effectAllowed="move";try{n.dataTransfer.setData("text/plain","")}catch(ln){}t.draggingNode=i,e.$emit("node-drag-start",i.node,n)})),this.$on("tree-node-drag-over",(function(n,i){var o=Nt(n.target,"ElTreeNode"),r=t.dropNode;r&&r!==o&&Object(Bt["c"])(r.$el,"is-drop-inner");var a=t.draggingNode;if(a&&o){var s=!0,c=!0,l=!0,d=!0;"function"===typeof e.allowDrop&&(s=e.allowDrop(a.node,o.node,"prev"),d=c=e.allowDrop(a.node,o.node,"inner"),l=e.allowDrop(a.node,o.node,"next")),n.dataTransfer.dropEffect=c?"move":"none",(s||c||l)&&r!==o&&(r&&e.$emit("node-drag-leave",a.node,r.node,n),e.$emit("node-drag-enter",a.node,o.node,n)),(s||c||l)&&(t.dropNode=o),o.node.nextSibling===a.node&&(l=!1),o.node.previousSibling===a.node&&(s=!1),o.node.contains(a.node,!1)&&(c=!1),(a.node===o.node||a.node.contains(o.node))&&(s=!1,c=!1,l=!1);var u,h=o.$el.getBoundingClientRect(),p=e.$el.getBoundingClientRect(),f=s?c?.25:l?.45:1:-1,v=l?c?.75:s?.55:0:1,y=-9999,g=n.clientY-h.top;u=g<h.height*f?"before":g>h.height*v?"after":c?"inner":"none";var m=o.$el.querySelector(".el-tree-node__expand-icon").getBoundingClientRect(),b=e.$refs.dropIndicator;"before"===u?y=m.top-p.top:"after"===u&&(y=m.bottom-p.top),b.style.top=y+"px",b.style.left=m.right-p.left+"px","inner"===u?Object(Bt["a"])(o.$el,"is-drop-inner"):Object(Bt["c"])(o.$el,"is-drop-inner"),t.showDropIndicator="before"===u||"after"===u,t.allowDrop=t.showDropIndicator||d,t.dropType=u,e.$emit("node-drag-over",a.node,o.node,n)}})),this.$on("tree-node-drag-end",(function(n){var i=t.draggingNode,o=t.dropType,r=t.dropNode;if(n.preventDefault(),n.dataTransfer.dropEffect="move",i&&r){var a={data:i.node.data};"none"!==o&&i.node.remove(),"before"===o?r.node.parent.insertBefore(a,r.node):"after"===o?r.node.parent.insertAfter(a,r.node):"inner"===o&&r.node.insertChild(a),"none"!==o&&e.store.registerNode(a),Object(Bt["c"])(r.$el,"is-drop-inner"),e.$emit("node-drag-end",i.node,r.node,o,n),"none"!==o&&e.$emit("node-drop",i.node,r.node,o,n)}i&&!r&&e.$emit("node-drag-end",i.node,null,o,n),t.showDropIndicator=!1,t.draggingNode=null,t.dropNode=null,t.allowDrop=!0}))},mounted:function(){this.initTabIndex(),this.$el.addEventListener("keydown",this.handleKeydown)},updated:function(){this.treeItems=this.$el.querySelectorAll("[role=treeitem]"),this.checkboxItems=this.$el.querySelectorAll("input[type=checkbox]")}},Vt=Ft,Rt=Object(a["a"])(Vt,ft,vt,!1,null,null,null),zt=Rt.exports,qt={name:"fc-org-transfer",components:{ElTree:zt},props:{value:{type:Object,default:function(){return{}}},tabList:{type:Array,default:function(){return["dep","role"]}},title:{type:String,default:"组织机构"},show:{type:Boolean,reuired:!0},searchable:{type:Boolean,default:!0},maxNum:{type:Number,default:99}},data:function(){return{searchRes:[],selectedData:[],aloneCheckedData:[],isEnough:!1,searchString:"",searchMode:!1,searchLoading:!1,activeTabName:"",tabConfig:[],tabKeys:[]}},computed:{selectedNum:function(){var e,t=0,n=Object(m["a"])(this.tabKeys);try{for(n.s();!(e=n.n()).done;){var i=e.value,o=this.selectedData[i];o&&o.length&&(t+=o.length);var r=this.aloneCheckedData[i];r&&r.length&&(t+=r.length)}}catch(a){n.e(a)}finally{n.f()}return t}},mounted:function(){this.isNumEnough(),this.debounceSearch=Te(this.searchDepUser,500)},methods:{handleTabClick:function(){this.node_had.childNodes=[],this.onLoad(this.node_had,this.resolve_had)},onLoad:function(e,t,n){var i=this,o=e.data&&e.data.subDepartList||[];o.length>0&&o.forEach((function(e){e.nodeId=e.id}));var r=this.tabConfig.find((function(e){return e.tabKey===n}));r.onload(e).then((function(e){if("role"==r.tabKey){var a=e.map((function(e){return Object(q["a"])({nodeId:r.nodeId(e)},e)}));a=Object(f["a"])(a),t(a)}else{var s=e.map((function(e){return Object(q["a"])({nodeId:r.nodeId(e)},e)}));s=[].concat(Object(f["a"])(o),Object(f["a"])(s)),t(s)}var c=i.$refs[n][0];i.selectedData[n].forEach((function(e){c.setMyChecked(e,!0,!0)}))})).then((function(e){var t=i.$refs[n][0];i.aloneCheckedData[n].forEach((function(e){t.setMyChecked(e,!0,!0)}))}))},searchDepUser:function(){var e=this;if(this.searchString){this.searchLoading=!0;var t=this.getActiveConf();new Promise((function(n,i){t.onsearch(e.searchString,n,i)})).then((function(n){e.searchRes=n.map((function(e){return Object(q["a"])({nodeId:t.nodeId(e),checked:!1},e)}));var i,o={},r=Object(m["a"])(e.tabKeys);try{for(r.s();!(i=r.n()).done;){var a=i.value;o[a]=e.selectedData[a].concat(e.aloneCheckedData[a])}}catch(c){r.e(c)}finally{r.f()}for(var s in o)o[s].forEach((function(t){e.searchRes.forEach((function(e){t.nodeId===e.nodeId&&(e.checked=!0)}))}))})).catch((function(e){return console.warn(e)})).finally((function(){return e.searchLoading=!1}))}else this.searchRes=[]},handleNodeClick:function(e){1==this.tabConfig.length&&"role"==this.tabConfig[0].tabKey&&(console.log("role",e),this.$set(this.selectedData,this.activeTabName,[e]))},onCheckChange:function(e,t,n){var i=this;this.activeTabName=n;var o=this.aloneCheckedData[n].findIndex((function(t){return t.nodeId===e.nodeId}));o>-1&&this.aloneCheckedData[n].splice(o,1),this.$nextTick((function(){var o=i.$refs[n][0],r=o.getCheckedNodes().map((function(e){return!e.nodeId&&(e.nodeId=i.getNodeProp(e,"nodeId",i.activeTabName)),e}));o.setMyChecked(e,t,!0),r=Ee(r,"id"),i.$set(i.selectedData,i.activeTabName,r),i.isNumEnough(),i.$forceUpdate()}))},searchItemClick:function(e){e.checked?(e.checked=!1,this.removeData(e,this.activeTabName,!0)):(e.checked=!0,this.addData(e))},addData:function(e){var t=this.activeTabName,n=this.$refs[t][0];n.setMyChecked(e,!0,!0),console.log("getChecked",n.getCheckedKeys(e)),!n.getCheckedKeys(e).includes(e.nodeId)&&!this.aloneCheckedData[t].find((function(t){return t.nodeId===e.nodeId}))&&this.aloneCheckedData[t].push(e),this.searchRes.forEach((function(t){e.nodeId===t.nodeId&&(t.checked=!0)}))},removeData:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(n){var i=this.aloneCheckedData[t].findIndex((function(t){return t.nodeId===e.nodeId}));i>-1&&this.aloneCheckedData[t].splice(i,1),this.$refs[t][0].setMyChecked(e,!1,!0)}else 1==this.tabConfig.length&&"role"==this.tabConfig[0].tabKey&&(this.selectedData.role=[]),this.$refs[t][0].setMyChecked(e,!1,!0);this.searchRes.forEach((function(t){e.nodeId===t.nodeId&&(t.checked=!1)}))},removeAll:function(){var e,t=this,n=Object(m["a"])(this.tabKeys);try{var i=function(){var n=e.value,i=t.$refs[n][0];i.getCheckedKeys().forEach((function(e){i.setCheckedKeys([])})),t.selectedData[n]=[],t.aloneCheckedData[n]=[]};for(n.s();!(e=n.n()).done;)i()}catch(o){n.e(o)}finally{n.f()}},isNumEnough:function(){var e,t=0,n=Object(m["a"])(this.tabKeys);try{for(n.s();!(e=n.n()).done;){var i=e.value;t+=this.selectedData[i].length,t+=this.aloneCheckedData[i].length}}catch(o){n.e(o)}finally{n.f()}this.isEnough=t>=this.maxNum},closeTransfer:function(){this.$emit("update:show",!1),this.tabKeys=[],this.isEnough=!1,this.searchString=""},confirm:function(){var e,t={},n=Object(m["a"])(this.tabKeys);try{for(n.s();!(e=n.n()).done;){var i=e.value;t[i]=this.selectedData[i].concat(this.aloneCheckedData[i])}}catch(o){n.e(o)}finally{n.f()}console.log("people-data",t),this.$emit("confirm",t),this.closeTransfer()},getActiveConf:function(e){var t=e||this.activeTabName;return this.tabConfig.find((function(e){return e.tabKey===t}))},getConfProp:function(e,t){var n=this.getActiveConf(t);return n?n[e]:null},getNodeProp:function(e,t,n){try{var i=this.getConfProp(t,n);if("string"===typeof i)return e[i];if("function"===typeof i)return i(e)}catch(ln){return console.error(ln),"执行出错，可联系开发人员"}},dataInit:function(){var e=this;this.aloneCheckedData={},this.selectedData={},this.tabConfig=[],this.tabKeys=[];var t=function(e){return"object"===Object(v["a"])(e)?[e.key,e.config]:[e,{}]},n=function(t,n){e.tabConfig.push(n),e.tabKeys.push(t);var i=e.value&&e.value[t]?e.value[t]:[];i=i.map((function(e){return Object(q["a"])({nodeId:n.nodeId(e)},e)})),e.$set(e.aloneCheckedData,t,i)};this.tabList.forEach((function(i){var o=t(i),r=Object(Ue["a"])(o,2),a=r[0],s=r[1];e.$set(e.aloneCheckedData,a,[]),e.$set(e.selectedData,a,[]);var c=pt.find((function(e){return e.tabKey===a}));c&&n(a,Object.assign({},c,s))})),this.activeTabName=this.tabKeys[0]}},watch:{searchString:function(e){this.searchMode=!!e,this.debounceSearch()},show:{handler:function(e){e&&(this.dataInit(),this.isNumEnough())},immediate:!0},tabList:{handler:function(e){this.dataInit()},immediate:!0,deep:!0}}},Ut=qt,Jt=(n("cfd3"),Object(a["a"])(Ut,ze,qe,!1,null,null,null)),Ht=Jt.exports,Gt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fc-org-select"},[n("div",{staticClass:"tags"},["button"===e.buttonType?n("el-button",{staticStyle:{"margin-bottom":"6px"},attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.show=!0}}},[e._v(" 添加"+e._s(e.title)+" ")]):e._e(),n("div",{staticClass:"input-box",class:{"as-input":"input"===e.buttonType},on:{click:function(t){e.show=!0}}},e._l(e.selectedData,(function(t){return n("el-tag",e._b({key:t.key,staticClass:"org-tag",on:{close:function(n){return e.onClose(t)}}},"el-tag",e.tagConfig,!1),[e._v(" "+e._s(t.label)+" ")])})),1)],1),n("fc-org-transfer",{ref:"transfer",attrs:{value:e.innerValue,title:e.title,searchable:e.searchable,maxNum:e.maxNum,tabList:e.tabList,show:e.show},on:{"update:show":function(t){e.show=t},confirm:e.onConfirm}})],1)},Wt=[],Yt={model:{prop:"value",event:"input"},name:"fc-org-select",props:{value:{type:null|Object,required:!0},tabList:{type:Array,default:function(){return["dep"]}},title:{type:String,default:"组织机构"},buttonType:{type:String,default:"input"},searchable:{type:Boolean,default:!0},maxNum:{type:Number,default:99},tagConfig:{type:Object,default:function(){return{type:"info",closable:!0,"disable-transitions":!1,hit:!1,color:void 0,size:"small",effect:"light"}}}},data:function(){return{tabKeys:[],show:!1,innerValue:null,selectedData:[]}},watch:{value:{handler:function(e){e&&this.reloadCmpData()},immediate:!0,deep:!0},tabList:{handler:function(e){var t=this;this.tabKeys=[],e.forEach((function(e){return t.tabKeys.push("string"===typeof e?e:e.key)})),this.reloadCmpData()},immediate:!0}},computed:{selectedLabels:function(){return this.selectedData.map((function(e){return e.label})).join(",")}},methods:{reloadCmpData:function(){var e=this;this.innerValue={},this.tabKeys.forEach((function(t){e.innerValue[t]=e.value&&e.value[t]?JSON.parse(JSON.stringify(e.value[t])):[]})),this.$nextTick((function(t){e.initSelectedData()}))},initSelectedData:function(){var e=this;this.selectedData=this.tabKeys.reduce((function(t,n){return t.concat(e.innerValue[n].map((function(t){return{tabKey:n,key:e.getKey(t,n),label:e.getLabel(t,n)}})))}),[])},getPropByKey:function(e,t,n){var i=this.$refs["transfer"];return i?i.getNodeProp(e,n,t):""},getKey:function(e,t){return this.getPropByKey(e,t,"nodeId")},getLabel:function(e,t){return this.getPropByKey(e,t,"label")},onClose:function(e){var t=this,n=this.innerValue[e.tabKey],i=n.findIndex((function(n){return t.getKey(n,e.tabKey)===e.key}));i>-1&&n.splice(i,1),this.initSelectedData(),this.$emit("input",this.innerValue)},onConfirm:function(e){this.innerValue=e,this.initSelectedData(),this.$emit("input",this.innerValue)}}},Qt=Yt,Xt=(n("4119"),Object(a["a"])(Qt,Gt,Wt,!1,null,"cae5a890",null)),Zt=Xt.exports,en=[Ht,Zt],tn=function(e){en.map((function(t){e.component(t.name,t)}))},nn={install:tn},on=(n("2b6c"),n("a7fe")),rn=n.n(on),an=n("00e7"),sn=n.n(an);function cn(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):null}i["default"].use(nn),i["default"].use(G.a),i["default"].use(rn.a,Z),i["default"].use(sn.a),i["default"].config.productionTip=!1,window.ccBillType=cn("billType"),window.ccAccountbookId=cn("accountbookId"),console.log("billtype",window.ccBillType,window.ccAccountbookId),new i["default"]({router:Me,store:Re,render:function(e){return e(l)}}).$mount("#app")},5801:function(e,t,n){},"7faf":function(e,t,n){"use strict";n("b8ff")},"830c":function(e,t,n){},"84f9":function(e,t,n){"use strict";n("e150")},8687:function(e,t,n){},"8b77":function(e,t,n){},aa9c:function(e,t,n){"use strict";n("5801")},b560:function(e,t,n){"use strict";n("8687")},b8ff:function(e,t,n){},bbed:function(e,t,n){},c9fb:function(e,t,n){"use strict";n("bbed")},cfd3:function(e,t,n){"use strict";n("8b77")},e150:function(e,t,n){},eaeb:function(e,t,n){}});
//# sourceMappingURL=app.61cf4358.js.map